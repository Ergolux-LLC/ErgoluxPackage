import logging
from uuid import UUID
from app.schemas.{{ table_name }} import {{ table_name|capitalize }}Update, {{ table_name|capitalize }}Response

logger = logging.getLogger(__name__)

class Update{{ table_name|capitalize }}:
    def __init__(self, relational_db):
        self.relational_db = relational_db

    def execute(self, item_id: UUID, payload: {{ table_name|capitalize }}Update) -> {{ table_name|capitalize }}Response | None:
        try:
            logger.info(f"Updating {{ table_name }} with id={item_id} and payload={payload.dict(exclude_unset=True)}")
            data = payload.dict(exclude_unset=True)
            updated = self.relational_db.update(item_id, data)
            if updated is None:
                logger.warning(f"Update failed: {{ table_name }} with id={item_id} not found")
                return None
            logger.info(f"Update successful for {{ table_name }} with id={item_id}")
            return {{ table_name|capitalize }}Response.from_orm(updated)
        except Exception as e:
            logger.exception(f"Exception during update of {{ table_name }} with id={item_id}: {e}")
            raise
